// 自動GUI生成ツール(function(){    if (app.documents.length ==0){        alert("新規にドキュメントを作成してください");        return;    }    var fileObj = File.saveDialog("保存するファイル名(拡張子.jsx)を入れてください");    if (!fileObj) return;	// キャンセルされたら何もしない    if (!fileObj.open("w")){        alert("ファイルに書き込むことができません");        return;    }    var CR = String.fromCharCode(13);   // 改行コードを変数に代入    var txtObj = app.activeDocument.textFrames;	// テキストフレームのみ対象    var text = "";    var posRight = 0;	// 右限    var posBottom = 0;	// 下限    for (var i=0; i<txtObj.length; i++){        var rect = txtObj[i].geometricBounds;        var l = (parseInt(rect[0]) | 0);	// 左の座標を読み出し整数化        var t = (-parseInt(rect[1]) | 0);	// 上の座標を読み出し整数化        var r = (parseInt(rect[2]) | 0);	// 右の座標を読み出し整数化        var b = (-parseInt(rect[3]) | 0);	// 下の座標を読み出し整数化        // テキストフレーム内の文字が、そのままGUIの種類と表示文字になる        var content = txtObj[i].contents;        var xType = (content.split("/")[0]).toLowerCase();        var xCont = content.split("/")[1];        var rectStr = l+","+t+","+r+","+b;        if (r > posRight) { posRight = r; }	// 最大の右幅をチェックしておく        if (b > posBottom) { posBottom = b; }	// 最大の下幅をチェックしておく        switch(xType){            case "ok" :                 text = text + "winObj['ok'] = winObj.add('button', ["+rectStr+"],'"+xCont+"', {name:'ok'});";                break;            case "cancel" :                text = text + "winObj['cancel'] = winObj.add('button', ["+rectStr+"],'"+xCont+"', {name:'cancel'});";                break;            default :                text = text + "winObj['item"+i+"'] = winObj.add('"+xType+"', ["+rectStr+"],'"+xCont+"');";        }        text = text + CR;    }    posRight = posRight + 20;	// ウィンドウのサイズ（右）    posBottom = posBottom + 20;	// ウィンドウのサイズ（下）    // GUIコードを生成    text = "var winObj = new Window('window', 'Sample', [0,0,"+posRight+","+posBottom+"]);" + CR + text + CR;    text = text + "winObj.center();"+CR;    text = text + "winObj.show();"+CR;    // ファイルに書き出し    fileObj.write(text);})();