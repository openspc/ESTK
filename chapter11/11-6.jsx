(function(){    // ==============================================    // Photoshopで動作させる関数。渡されたファイルをまとめて開く    // ==============================================    function photoshop_open(){        for(var i=0; i<arguments.length; i++){            try{ app.open(new File(arguments[i])); }catch(e){}        }    }    // ==============================================    // GUI処理部分    // ==============================================    var folderObj;   // フォルダオブジェクトの変数    // ウィンドウオブジェクトを生成する    var winObj = new Window("window", "一括して開く", [ 0,0, 220, 140]);    // ドロップダウンリストを生成する    var dropList = winObj.add("dropdownlist", [10, 20, 210, 50], ["PSD", "JPEG", "PNG", "GIF", "TIFF", "全ての種類"]);    // 各種ボタンを表示する    var selectBtn = winObj.add("button", [10, 60, 210, 85], "フォルダを指定する...");    var openBtn = winObj.add("button", [10, 100, 210, 125], "Photoshopで開く");    // フォルダを選択するボタンがクリックされた時の処理    selectBtn.onClick = function(){        folderObj = Folder.selectDialog("画像があるフォルダを指定してください");    }    // ファイルを開くボタンがクリックされた時の処理    openBtn.onClick = function(){        // ファイルの種類が選択されているか確認        if(!dropList.selection){            alert("ファイルの種類を指定してください");            return;        }        // 開くファイルの拡張子（ワイルドカード）        var extList = ["*.psd", "*.jpg", "*.png", "*.gif", "*.tiff", "*"];        // 選択された種類から拡張子を求める        var ext = extList[dropList.selection.index];        // 指定された拡張子のファイル一覧を取得        var fileList = folderObj.getFiles(ext);        // 開くファイルがない場合は処理しない        if (fileList.length == 0){            alert("開くファイルがありません");            return;        }        // photoshopに渡すファイルのフルパスの文字列を生成        var args = "";        for(var i=0; i<fileList.length; i++){            args = args + "'"+fileList[i].fsName + "',";        }        // BridgeTalkオブジェクトを生成        var bt = new BridgeTalk();        // 実行するアプリケーションをPhotoshopにする        bt.target = BridgeTalk.getSpecifier("photoshop");        // 実行する関数とパラメーターを設定        bt.body = uneval(photoshop_open)+"("+args+")";        // Photoshopの処理が完了した場合に呼び出す処理        bt.onResult = function(){            alert("Photoshopでの処理が完了しました");        }        bt.send();  // 実行開始    }    // ウィンドウを中央に移動する    winObj.center();    // ウィンドウを表示する    winObj.show();})();