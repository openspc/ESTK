(function(){    // 連結したいフォルダを指定する    var folderObj = Folder.selectDialog("連結したいテキストファイルがあるフォルダを選択してください");    if (!folderObj){ return; }  // キャンセルされた場合は何も処理しない    // ファイル保存ダイアログを表示する    var saveObj = File.saveDialog("連結したファイルの保存先を指定してください");    if (!saveObj){ return; }    // キャンセルされた場合は何も処理しない    // 書き込めるかどうか調べる    var flag = saveObj.open("w");    if (!flag){        alert("ファイルが書き込めません");    }    // 保存する文字コードを指定する    saveObj.encoding = "utf-8";    // 改行コードをWindows (CR/LF) にする    saveObj.lineFeed = "windows";    // ファイル連結処理をする関数を呼び出す    connect(folderObj);    saveObj.close();    alert("終了しました");    // フォルダ内のテキストファイルを連結する関数    function connect(folderObj){        // ファイル/フォルダ一覧を取得する        var fileList = folderObj.getFiles("*.txt");        // ファイルの数だけ読み出す        for(var i=0; i<fileList.length; i++){            // 全部読み出して書き出す            var flag = fileList[i].open("r");   // ファイルを読み込みモードで開く            if (flag == true){  // 開くのに成功した場合は以後の処理を行う                var text = fileList[i].read();  // 全部読み込む                saveObj.writeln("■■■■　" + fileList[i].fsName);                saveObj.writeln(text);  // 改行を入れておく            }        }        // フォルダを含めた一覧を取得する        fileList = folderObj.getFiles();        for(var i=0; i<fileList.length; i++){            // フォルダかどうか調べる            if(fileList[i].getFiles){                connect(fileList[i]);  // フォルダの場合は再帰呼び出し            }        }    }})();