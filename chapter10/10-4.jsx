(function(){    // 一覧を取得したいフォルダを指定する    var folderObj = Folder.selectDialog("一覧を取得したいフォルダを選択してください");    if (!folderObj){ return; }  // キャンセルされた場合は何も処理しない    // ファイル保存ダイアログを表示する    var saveObj = File.saveDialog("保存先を指定してください");    if (!saveObj){ return; }    // キャンセルされた場合は何も処理しない    // 書き込めるかどうか調べる    flag = saveObj.open("w");    if (!flag){        alert("ファイルが書き込めません");    }    // ファイル/フォルダ一覧を取得する    var fileList = folderObj.getFiles();    // 保存する文字コードを指定する    saveObj.encoding = "utf-8";    // ファイルの数だけ書き出す    for(var i=0; i<fileList.length; i++){        var filename = decodeURI(fileList[i].name);        saveObj.write(filename);        // フォルダかどうか調べる        if(fileList[i].getFiles){            saveObj.write("　【フォルダ】");        }        saveObj.writeln();  // 改行する    }    // ファイル総数を書き出す    saveObj.writeln("--------------------");    saveObj.writeln("ファイル/フォルダの総数："+fileList.length);})();