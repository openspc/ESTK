(function(){    // 一覧を取得したいフォルダを指定する    var folderObj = Folder.selectDialog("一覧を取得したいフォルダを選択してください");    if (!folderObj){ return; }  // キャンセルされた場合は何も処理しない    // ファイル保存ダイアログを表示する    var saveObj = File.saveDialog("保存先を指定してください");    if (!saveObj){ return; }    // キャンセルされた場合は何も処理しない    // 書き込めるかどうか調べる    var flag = saveObj.open("w");    if (!flag){        alert("ファイルが書き込めません");    }    // 保存する文字コードを指定する    saveObj.encoding = "utf-8";    // ファイル総数を入れる変数を用意する    var count = 0;    makeList(folderObj)    // ファイル総数を書き出す    saveObj.writeln("--------------------");    saveObj.writeln("JPEGファイルの総数："+count);    alert("終了しました");    // JPEGファイルを求める関数    function makeList(folderObj){        // ファイル/フォルダ一覧を取得する        var fileList = folderObj.getFiles("*.jpg");        // ファイルの数だけ書き出す        for(var i=0; i<fileList.length; i++){            try{    // ファイル名に%が含まれるとエラになるので回避                var filename = decodeURI(fileList[i].fsName);            }catch(e){                var filename = fileList[i].fsName;            }            saveObj.writeln(filename);    // ファイル名を保存する            count = count + 1;  // カウントする        }        // フォルダを含めた一覧を取得する        fileList = folderObj.getFiles();        for(var i=0; i<fileList.length; i++){            // フォルダかどうか調べる            if(fileList[i].getFiles){                makeList(fileList[i]);  // フォルダの場合は再帰呼び出し            }        }    }})();