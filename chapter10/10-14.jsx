(function(){    // 一覧を取得したいフォルダを指定する    var folderObj = Folder.selectDialog("一覧を取得したいフォルダを選択してください");    if (!folderObj){ return; }  // キャンセルされた場合は何も処理しない    // デスクトップの00jpegLsitフォルダに保存する    var saveFolder = new Folder(Folder.desktop+"/00jpegList");    saveFolder.create();    // フォルダを作成    makeAliasList(folderObj);    alert("終了しました");    // JPEGファイルを求め栄アリアスを作成する関数    function makeAliasList(folderObj){        // JPEGファイル一覧を取得する        var fileList = folderObj.getFiles("*.jpg");        // ファイルの数だけエイリアスとして書き出す        for(var i=0; i<fileList.length; i++){            var size = fileList[i].length;  // ファイルサイズを求める            if (size >= 400*1024){  // 400KB以上の場合だけエイリアスを作成                // ファイル名が重複しないようにスラッシュをアンダーバーにしたファイル名を使う                var filename = fileList[i].fsName.replace(new RegExp("/", "g"), "_");                // エイリアスとなるファイルオブジェクトを作成する                var aliasFileObj = new File(saveFolder+"/"+filename);                // エイリアスを作成する                var flag = aliasFileObj.createAlias(fileList[i]);                if (flag == false){                    $.writeln("失敗："+filename);                }            }        }        // フォルダを含めた一覧を取得する        fileList = folderObj.getFiles();        for(var i=0; i<fileList.length; i++){            // フォルダかどうか調べる            if(fileList[i].getFiles){                makeAliasList(fileList[i]);  // フォルダの場合は再帰呼び出し            }        }    }})();