(function(){    // ファイル選択ダイアログを表示する    var fileObj = File.openDialog("重複行を削除するテキストファイルを選択してください");    if (!fileObj){ return; }    // キャンセルされた場合は何も処理しない    // ファイル保存ダイアログを表示する    var saveObj = File.saveDialog("保存先を指定してください");    if (!saveObj){ return; }    // キャンセルされた場合は何も処理しない    // ファイルが読み込めるかどうか調べる    var flag = fileObj.open("r");   // 読み込みモードで開く    if (!flag){        alert("ファイルが開けません");        return;    }    // 書き込めるかどうか調べる    flag = saveObj.open("w");    if (!flag){        alert("ファイルが書き込めません");    }    // 行番号を示す変数    var lineCount = 0;    // ファイルの最後まで繰り返し処理する    while(!fileObj.eof){        var line = fileObj.readln();    // 1行読み込む        // 行番号を増やす        lineCount = lineCount + 1;        // 行番号を先頭に加えて書き出す        var text = lineCount + " : " + line;        saveObj.writeln(text);    }    saveObj.close();    $.writeln(lineCount+"行ありました");    alert("終了しました");})();