(function(){    // ファイル選択ダイアログを表示する    var fileObj = File.openDialog("重複行を削除するテキストファイルを選択してください");    if (!fileObj){ return; }    // キャンセルされた場合は何も処理しない    // ファイル保存ダイアログを表示する    var saveObj = File.saveDialog("保存先を指定してください");    if (!saveObj){ return; }    // キャンセルされた場合は何も処理しない    // ファイルが読み込めるかどうか調べる    var flag = fileObj.open("r");   // 読み込みモードで開く    if (!flag){        alert("ファイルが開けません");        return;    }    // 書き込めるかどうか調べる    flag = saveObj.open("w");    if (!flag){        alert("ファイルが書き込めません");    }    // 重複行を入れるための配列変数（連想配列/ハッシュとして利用）    var temp = [];    // ファイルの最後まで繰り返し処理する    while(!fileObj.eof){        var line = fileObj.readln();    // 1行読み込む        // 空行は処理しないようにする        if (line == ""){            saveObj.writeln(line);            continue;        }        // 重複行かどうか調べる        if (!temp[line]){   // 重複していない            temp[line] = true;  // trueを設定することで、すでにこの行の内容が存在することを示す            saveObj.writeln(line);  // 書き出す        }    }    saveObj.close();    alert("終了しました");})();